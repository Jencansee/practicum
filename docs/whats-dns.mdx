---
title: 'Компоненты сетей: DNS'
section: Компьютерные сети и информационная безопасность
---

## **Что такое DNS?**

DNS (Domain Name System, система доменных имён) - иерархическая, распределенная в сети система баз данных, предоставляющая пользователям сети Интернет дополнительный сервис (технически реализованный на компьютерах - DNS-серверах, на которых запущено специальное программное обеспечение) по автоматическому преобразованию запросов, оформленных в удобном для человека текстовом формате (например, www.test.ru) в цифровой IP-адрес компьютера (например, 192.1.1.1), где находится искомый ресурс.&#x20;

Иерархию DNS чаще всего представляют в виде древовидной структуры. В основе этого дерева находится корневой домен "." (root), далее идут домены первого уровня TLD (top level domains). За доменами первого уровня не закреплено никаких IP-адресов, они предназначены для создания на их основе (в их зонах) доменов второго уровня с последующим закреплением за ними IP-адресов.

> Система доменных имён появилась на заре становления интернета. Тогда для сопоставления IP-адреса и связанного с ним имени использовался простой текстовый файл — `HOSTS.TXT`. Чтобы с его помощью узнать имя хоста и его адрес для подключения либо занести свои данные, нужно было позвонить в сетевой информационный центр. Когда стало понятно, что это слегка неудобно, появились первые DNS-серверы.

![](https://res.cloudinary.com/dzfsp6wbp/image/upload/v1654027846/selectel\_crwe36.jpg "")

## **Как работает DNS?**

DNS работает в режиме вопрос/ответ. Допустим, Вы ввели в строке своего браузера "test.ru".
Рассмотрим работу DNS пошагово:

1.  Ваш браузер об IP-адресе test.ru ничего не знает и с запросом IP-адреса через специальную программу-resolver обращается к локальному серверу имен. Локальный DNS-сервер - это сервер имен Вашей локальной сети или DNS-сервер Вашего интернет-провайдера. "Откуда браузеру известно о существовании этого локального DNS?" - спросите Вы. Все предельно просто. При настройках сетевого подключения Вы прописываете IP-адреса DNS-серверов (предпочитаемого и/или альтернативного), один из которых будет отвечать на запросы, посылаемые Вашим браузером через resolver - это и есть локальный или местный сервер Вашей сети. Вы всегда можете посмотреть IP-адрес Вашего локального DNS-сервера. Для этого достаточно посмотреть свойства сетевого подключения, используемого на Вашем компьютере.
2.  Первым делом браузер проверяет свой кэш — не сохранился ли IP-адрес запрашиваемого ресурса с прошлого подключения. Если адрес найден, браузер выполняет прямой запрос по нему. 
3.  Если адрес не найден, браузер отправляет запрос к встроенному в операционную систему DNS-резолверу. Тот также проверяет свой кэш и кэш ОС. Если адрес найден, он возвращается браузеру.
4.  Когда адрес в памяти отсутствует, ваш DNS-резолвер отправляет запрос DNS-резолверу интернет-провайдера. Его адрес автоматически прописывается в вашей системе. Также широко распространены резолверы Google — 8.8.8.8 и 4.4.4.4. Резолвер провайдера тоже проверяет свой кэш — не записан ли там адрес запрашиваемого ресурса. Если адрес найден, он возвращается нашему резолверу. 
5.  В ином случае DNS-резолвер провайдера зрит в корень — опрашивает корневые DNS-серверы. Они неявно указаны в любом домене — в виде точки в конце имени, которую мы для упрощения запоминания и работы обычно опускаем: `firstvds.ru[.]` Корневые серверы проверяют у себя наличие информации о введёном имени — точнее, о домене верхнего уровня `.RU`. Если информация найдена, корневой сервер возвращает адрес DNS-сервера доменной зоны (TLD DNS-сервера). Если нет — возвращает ошибку: значит, запрошенной зоны не существует.
6.  Получив адрес сервера зоны, резолвер отправляет запрос к нему. Сервер зоны проверяет у себя наличие информации о домене второго уровня — `FIRSTVDS.RU`. Если такой домен существует, TLD-сервер вернёт адрес авторитативного сервера, где хранится информация об этом домене — его ресурсные записи. Если домен не существует — сервер вернёт ошибку: значит, домен не зарегистрирован, ещё не внесён регистратором в реестр либо не делегирован на серверы имён.
7.  Определив адрес авторитативного сервера, резолвер опрашивает его — всё о том же домене второго уровня. Авторитативный сервер проверяет свою базу данных, и, если домен там присутствует, возвращает его IP-адрес — он записан в ресурсной `А`-записи домена (или `AAAA` для IPv6). В некоторых случаях она может отсутствовать — например, удалена вручную по каким-то причинам. Тогда, как и при отсутствии домена в базе, будет возвращена ошибка — резолвер вернётся ни с чем.
8.  Когда адрес нашего домена наконец найден, резолвер провайдера записывает его в свой кэш и передаёт нашему встроенному резолверу. Тот записывает его в свою внутреннюю память и возвращает адрес браузеру. Браузер выполняет прямой запрос к полученному IP-адресу, и начинается загрузка данных сайта — открывается запрошенная страница.
9.  Запрос на IP-адрес test.ru доходит до местного сервера имен. Этот сервер о данном IP-адресе ничего не знает и посылает запрос одному из корневых серверов "." (root).
10. Корневой сервер отдает локальному серверу IP-адрес сервера, который поддерживает зону .ru.
11. Далее по полученному адресу локальный сервер имен обращается к DNS-серверу, который поддерживает .ru.
12. Этот DNS-сервер, в свою очередь, по полученному запросу отдает IP-адрес сервера, который поддерживает зону test.ru.
13. Местный DNS-сервер с запросом IP-адреса test.ru обращается к DNS-серверу зоны test.ru.
14. Локальный сервер имен получает IP-адрес test.ru. от DNS-сервера зоны test.ru.
15. Получив адрес test.ru, локальный DNS-сервер сообщает его Вашему браузеру.

## Что такое DNS-зоны?

В этой статье мы рассматриваем лишь вариант «один домен — один IP-адрес». На самом деле, ситуация может быть и сложнее. Так, с определенным доменным именем может быть связано несколько ресурсов — сайт и почтовый сервер. У этих ресурсов вполне могут быть разные IP-адреса, что дает возможность повысить надежность и эффективность работы сайта или почтовой системы. Есть у сайтов и поддомены, IP-адреса которых тоже могут быть разными.

Вся эта информация о связи сайта, поддоменов, почтовой системы хранится в специальном файле на DNS-сервере. Его содержимое называется DNS-зона. Файл содержит следующие типы записей:

*   А — адрес веб-ресурса, который привязан к конкретному имени домена.
*   MX — адрес почтового сервера.
*   CNAME — чаще всего этот тип записи используется для подключения поддомена.
*   NS — адрес DNS-сервера, который отвечает за содержимое других ресурсных записей.
*   TXT — любая текстовая информация о доменном имени.
*   SPF — данные с указанием списка серверов, которые входят в список доверенных для отправки писем от имени указанного домена.
*   SOA — исходная запись зоны, в которой указаны сведения о сервере и которая содержит шаблонную информацию о доменном имени.


